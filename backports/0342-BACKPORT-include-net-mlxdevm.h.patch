From: Maher Sanalla <msanalla@nvidia.com>
Subject: [PATCH] BACKPORT: include/net/mlxdevm.h

Change-Id: I29444f0065587da613d8ad8a6e6ad1890aa1cd2a
---
 include/net/mlxdevm.h | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

--- a/include/net/mlxdevm.h
+++ b/include/net/mlxdevm.h
@@ -83,7 +83,7 @@ struct mlxdevm_ops {
 	 * @dev: mlxdevm instance
 	 * @attrs: attributes of the new port
 	 * @extack: extack for reporting error messages
-	 * @new_port_index: index of the new port
+	 * @new_port_index/@dl_port: index of the new port/output pointer for the new port
 	 *
 	 * Mlxdevm core will call this device driver function upon user request
 	 * to create a new port function of a specified flavor and optional
@@ -99,7 +99,11 @@ struct mlxdevm_ops {
 	int (*port_new)(struct mlxdevm *dev,
 			const struct mlxdevm_port_new_attrs *attrs,
 			struct netlink_ext_ack *extack,
+#ifdef HAVE_DEVLINK_PORT_OPS
+			struct devlink_port **dl_port);
+#else
 			unsigned int *new_port_index);
+#endif
 	/**
 	 * port_del() - Delete a port function
 	 * @dev: mlxdevm instance
